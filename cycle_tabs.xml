<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE muclient>
<!-- Saved on Sunday, March 25, 2018, 9:50 PM -->
<!-- MuClient version 5.06-pre -->

<!-- Plugin "cycle_tabs" generated by Plugin Wizard -->

<muclient>
<plugin
   name="cycle_tabs"
   author="Daak"
   id="3a01e1807c17390aa06135a8"
   language="Lua"
   purpose="Cycle through channel tabs"
   save_state="y"
   date_written="2018-03-25 21:49:47"
   requires="5.06"
   version="1.0"
   >

</plugin>


<!--  Get our standard constants -->

<include name="constants.lua"/>

<aliases>
  <alias
    match="^settab (\d+)$"
    script="settab_number"
    name="settab_number"
    enabled="y" regexp="y" sequence="100" ignore_case="y"
    >
  </alias>
  <alias
    match="^settab (\w+)$"
    script="settab_name"
    name="settab_name"
    enabled="y" regexp="y" sequence="101" ignore_case="y"
    >
  </alias>
</aliases>
<!--  Script  -->


<script>
<![CDATA[
function tableCountItems(ttable)
  local count = 0
  for i,v in pairs(ttable) do
    count = count + 1
  end
  if count == 0 then
    for i,v in ipairs(ttable) do
      count = count + 1
    end
  end
  return count
end

-- this won't be accurate with a Save but maybe it does not matter
-- as long as num_tabs is correct eventually we sync up
current_tab = GetPluginVariable("b555825a4a5700c35fa80780", "current_tab")
loadstring(GetPluginVariable("b555825a4a5700c35fa80780", "tabs_names") or "")()
num_tabs = tableCountItems(tabs_names)

function nextTab()
   local next_tab = current_tab + 1
   if next_tab > num_tabs then
     next_tab = 1
   end
   current_tab = next_tab
   CallPlugin("b555825a4a5700c35fa80780", "setTab", next_tab)
end

function prevTab()
   local prev_tab = current_tab - 1
   if prev_tab < 1 then
     prev_tab = num_tabs
   end
   current_tab = prev_tab
   CallPlugin("b555825a4a5700c35fa80780", "setTab", prev_tab)
end

function settab_number (name, line, wildcards)
   tab_id = tonumber(wildcards[1])
   if tabs_names[tab_id] == nil then
     Note("Invalid tab number")
     return
   end
   current_tab = tab_id
   CallPlugin("b555825a4a5700c35fa80780", "setTab", tab_id)
end

function settab_name (name, line, wildcards)
   local tab_name = wildcards[1]
   local tab_id = 0
   for i,v in ipairs(tabs_names) do
     if v == tab_name then
       tab_id = i
     end
   end
   if tab_id == 0 then
     Note("Tab name not found")
     return
   end
   current_tab = tab_id
   CallPlugin("b555825a4a5700c35fa80780", "setTab", tab_id)
end

Accelerator("alt + right", '\\\\\\CallPlugin("3a01e1807c17390aa06135a8", "nextTab")')
Accelerator("alt + left", '\\\\\\CallPlugin("3a01e1807c17390aa06135a8", "prevTab")')

]]>
</script>


</muclient>
